<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> 
<html class="no-js"> <!--<![endif]-->
  <head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
    <link href="http://mikesmithdev.com/styles/fullcalendar.css" rel="stylesheet" type="text/css" />
    <script src="http://mikesmithdev.com/scripts/not-used/fullcalendar.min.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="divider"></div>
      <div class="row">
        <div class="grid_8">
          <div>
            <div style="float: left; display: inline-block; background-color: #9fc6e7; padding: 8px; color: #1d1d1d; border: solid 1px #1587bd; margin-right: 10px;">
              <input type="checkbox" checked="checked" onclick="reloadCal()" name="e1" id="e1" />
              <label for="e1">Event Type 1</label>
            </div>
            <div style="float: left; display: inline-block; background-color: #7c6995; padding: 8px;color: #fff; border: solid 1px #5b447a; margin-right: 10px;">
              <input type="checkbox" checked="checked" onclick="reloadCal()" name="e2" id="e2" />
              <label for="e2">Event Type 2</label>
            </div>
            <div style="float: left; display: inline-block; background-color: #ccc; padding: 8px;color: #000; border: solid 1px #666; margin-right: 10px;">
              <input type="checkbox" checked="checked" onclick="reloadCal()" name="e3" id="e3" />
              <label for="e3">Event Type 3</label>
            </div>
            <div style="clear: both; height: 15px;"></div>
          </div>
          <div>
          <div id="calendar"></div>
        </div>
</div>


    <script type="text/javascript">
      var source = new Array();
      source[0] = '/event_instances.json'
      var newSource = new Array();
      newSource[0] = source[0];
      $(document).ready(loadCal);
      
      function reloadCal() {
        newSource[0] = '/event_instances.json';
        $('#calendar')
          .fullCalendar('removeEventSource', source[0])
          .fullCalendar('refetchEvents')
          .fullCalendar('addEventSource', newSource[0])
          .fullCalendar('refetchEvents');
        source[0] = newSource[0];
      }

      function loadCal() {
      
      var new_event_link = "#{new_event_path}"
      $('#calendar').fullCalendar({
        dayClick: function(date, allDay, jsEvent, view) {
          document.location.href=new_event_link + "?start_date=" + date;
        },
          header: {
              left: 'prev,today,next',
              center: 'title',
              right: 'month,agendaWeek,agendaDay'
          },
          selectable: true,
          selectHelper: true,
          editable: false,
          ignoreTimezone: false,
          select: this.select,
          eventClick: this.eventClick,
          eventDrop: this.eventDropOrResize,
          eventSources: [
            {
                url: '/event_instances.json',
                data: {
                    custom_param1: 'something',
                    custom_param2: 'somethingelse'
                },
                error: function() {
                    alert('there was an error while fetching events!');
                }
            }
          ],
          eventResize: this.eventDropOrResize
      });
      }
    </script>
  </body>
</html>
